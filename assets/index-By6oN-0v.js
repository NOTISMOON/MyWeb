import{d as ie,s as n,y as ue,O as de,P as I,N as O,x as ve,c as i,g as ce,a as t,j as R,b as U,H as Q,n as W,t as d,C as S,F as D,D as A,Q as me,o as u}from"./index-M1UoG1Yi.js";import{v as pe,a as G,_ as fe}from"./utils-DvqIGp0K.js";import{d as he}from"./index.vue_vue_type_script_setup_true_lang-CEyQ4nHz.js";const ge={class:"bg-light h-full w-full font-inter"},xe={class:"container mx-auto px-4 py-6 relative"},we={class:"max-w-4xl mx-auto mb-10 relative mt-[5rem]"},ye={class:"aspect-video bg-dark rounded-xl overflow-hidden shadow-lg relative hover-lift"},be=["src"],ke={key:0,class:"absolute inset-0 flex items-center justify-center bg-dark/40 bg-blur"},_e={class:"px-6 pb-2"},Me={key:0,class:"absolute -top-8 left-1/2 -translate-x-1/2 bg-dark bg-blur text-light text-xs px-2 py-1 rounded whitespace-nowrap"},Ce={class:"flex justify-between text-light/90 text-sm mt-1"},Te={class:"px-6 pb-6 flex items-center gap-6 text-light/90"},Ve={key:0,class:"w-7 h-7",fill:"currentColor",viewBox:"0 0 24 24"},ze={key:1,class:"w-7 h-7",fill:"currentColor",viewBox:"0 0 24 24"},Ee={class:"flex items-center gap-2 group"},Le={key:0,class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24"},Be={key:1,class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24"},$e={key:2,class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24"},He=["value"],Se={class:"relative group"},je={class:"text-sm flex items-center gap-1 transition-colors hover:text-primary"},Re={class:"absolute bottom-full left-0 mb-2 bg-dark bg-blur rounded-md shadow-xl w-24 opacity-0 group-hover:opacity-100 transition-all duration-200 origin-bottom"},De=["onClick"],Pe={key:0,class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24"},Ne={key:1,class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24"},Fe={class:"flex flex-col lg:flex-row gap-8 max-w-6xl mx-auto relative"},Xe={class:"lg:w-2/3"},qe={class:"text-[clamp(1.5rem,3vw,2.2rem)] font-bold text-dark mb-4 leading-tight text-gradient"},Ie={class:"flex flex-wrap items-center gap-x-6 gap-y-2 text-dark/70 mb-6"},Oe={class:"flex items-center gap-1.5"},Ue={class:"flex items-center gap-1.5"},Qe={class:"px-2 py-0.5 bg-secondary/10 text-secondary rounded text-xs font-medium"},We={class:"bg-light border border-primary/10 rounded-xl shadow-sm p-5 mb-6 transition-all duration-300 hover:shadow-md"},Ae={class:"text-dark/70 leading-relaxed whitespace-pre-line"},Ge={class:"lg:w-1/3"},Je={class:"text-xl font-bold text-dark mb-4 flex items-center gap-2"},Ke={class:"text-sm font-normal text-dark/50 ml-2"},Ye={key:0,class:"space-y-4"},Ze=["onClick"],et={class:"w-2/5 relative aspect-video rounded-l-lg overflow-hidden flex-shrink-0 border-r border-primary/5"},tt=["src"],lt={class:"absolute bottom-1.5 right-1.5 bg-dark/80 bg-blur text-light text-xs px-1.5 py-0.5 rounded"},at={class:"w-3/5 p-3"},ot={class:"font-medium text-dark line-clamp-2 mb-2 transition-colors hover:text-primary"},st={class:"text-dark/40 text-xs"},nt=ie({__name:"index",setup(rt){const E=de(),J=me(),r=n({title:"",url:"",cover:"",uploadTime:"",category:"",desc:"",duration:"",status:1,id:NaN}),f=n([]),o=n(null),C=n(null),c=n(!1),p=n(!1),w=n(1),L=n(0),y=n(0),b=n(0),k=n(!1),_=n(!1),M=n(!1),P=n(!1),B=n(0),h=n(null);ue(async()=>{var x;E.query.id&&(r.value=E.query);const a=new pe(+E.params.id);a.getVideoInof()&&(r.value=a.getVideoInof()),(x=window.opener)==null||x.postMessage({type:"readplay"},window.location.origin);const e=()=>new Promise(s=>{window.addEventListener("message",async m=>{m.origin===window.location.origin&&(m.data.type==="videoData"&&(m.data.url=$(m.data.url),r.value=await m.data,a.setViodeInof(r.value)),s())}),window.removeEventListener("message",e)});r.value.category||await e();const l=await I(r.value.category);if(l.data.map(s=>(s.url=$(s.url),s.uploadTime=G(s.uploadTime),s)),l.data=l.data.filter(s=>s.category===r.value.category&&s.id!==r.value.id),l.data.length<=2)f.value=l.data;else for(let s=0;s<2;s++)f.value.push(l.data[Math.floor(Math.random()*(l.data.length-2)+1)]);document.addEventListener("mousemove",g);const v=()=>{P.value=!!document.fullscreenElement};document.addEventListener("fullscreenchange",v),O(()=>{document.removeEventListener("fullscreenchange",v)})}),O(()=>{h.value!==null&&(window.clearTimeout(h.value),h.value=null),document.removeEventListener("mousemove",g),V()}),ve(()=>E.query,async a=>{r.value=a;const e=await I(r.value.category);if(e.data.map(l=>(l.url=$(l.url),l.uploadTime=G(l.uploadTime),l)),e.data=e.data.filter(l=>l.category===r.value.category&&l.id!==r.value.id),f.value=[],e.data.length<=2)f.value=e.data;else for(let l=0;l<2;l++)f.value.push(e.data[Math.floor(Math.random()*(e.data.length-2)+1)])});const $=a=>"https://websarvice-190762-4-1381433578.sh.run.tcloudbase.com"+a,K=async()=>{if(o.value){y.value=o.value.duration||0,o.value.volume=w.value,o.value.muted=p.value;try{await o.value.play(),c.value=!0}catch{try{o.value.muted=!0,await o.value.play(),c.value=!0,p.value=!0}catch{c.value=!1}}}},N=async()=>{if(o.value){if(c.value)o.value.pause(),c.value=!1;else try{await o.value.play(),c.value=!0}catch{o.value.muted=!0,p.value=!0,await o.value.play().catch(()=>{}),c.value=!o.value.paused}g()}},Y=()=>{o.value&&(o.value.muted=!p.value,p.value=!p.value)},Z=a=>{const e=a.target;w.value=parseFloat(e.value),o.value&&(o.value.volume=w.value,w.value>0&&p.value&&(o.value.muted=!1,p.value=!1))},ee=()=>{o.value&&(L.value=o.value.currentTime||0,!y.value||y.value===0?b.value=0:b.value=L.value/y.value*100)},te=a=>{var m,z;if(!o.value||!C.value)return;const e=C.value.getBoundingClientRect();let l=0;a instanceof TouchEvent?l=((z=(m=a.changedTouches)==null?void 0:m[0])==null?void 0:z.clientX)??0:l=a.clientX;const v=l-e.left,x=Math.max(0,Math.min(1,v/e.width)),s=x*(y.value||0);b.value=x*100,B.value=s,o.value.currentTime=s},F=a=>{document.body.style.userSelect=a?"":"none"},X=a=>{M.value=!0,F(!1),document.addEventListener("mousemove",T),document.addEventListener("mouseup",V),document.addEventListener("touchmove",T,{passive:!1}),document.addEventListener("touchend",V),T(a)},T=a=>{var m,z;if(!C.value)return;a.cancelable&&a.preventDefault();const e=C.value.getBoundingClientRect();let l=0;a instanceof TouchEvent?l=((z=(m=a.touches)==null?void 0:m[0])==null?void 0:z.clientX)??0:l=a.clientX;const v=l-e.left,x=Math.max(0,Math.min(1,v/e.width)),s=x*(y.value||0);b.value=x*100,B.value=s,M.value&&o.value&&(o.value.currentTime=s)},V=()=>{M.value=!1,F(!0),document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",V),document.removeEventListener("touchmove",T),document.removeEventListener("touchend",V),o.value&&(o.value.currentTime=B.value)},le=()=>{var e,l;const a=document.querySelector(".aspect-video");a&&(document.fullscreenElement?(l=document.exitFullscreen)==null||l.call(document).catch(()=>{}):(e=a.requestFullscreen)==null||e.call(a).catch(()=>{}))},ae=()=>{c.value=!1,L.value=0,b.value=0,_.value=!0},H=n(1),oe=n([.5,.75,1,1.25,1.5,2]),se=a=>{H.value=a,o.value&&(o.value.playbackRate=a)},q=()=>{h.value!==null&&(window.clearTimeout(h.value),h.value=null)},ne=()=>{q(),!(!c.value||k.value)&&(h.value=window.setTimeout(()=>_.value=!1,2e3))},g=()=>{_.value=!0,q(),!(!c.value||k.value)&&(h.value=window.setTimeout(()=>_.value=!1,2e3))},j=a=>{if(!a||Number.isNaN(a))return"0:00";const e=Math.floor(a/3600),l=Math.floor(a%3600/60),v=Math.floor(a%60);return e>0?`${e}:${l.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}`:`${l}:${v.toString().padStart(2,"0")}`},re=a=>J.push({name:"player",query:{...a},params:{id:a.id},force:!0});return(a,e)=>(u(),i(D,null,[ce(he,{id:"navbar"}),t("div",ge,[t("div",xe,[e[23]||(e[23]=t("div",{class:"absolute top-20 left-1/2 -translate-x-1/2 w-[80%] h-96 bg-primary/5 rounded-full blur-3xl -z-10"},null,-1)),t("div",we,[e[15]||(e[15]=t("div",{class:"flex items-center gap-3 mb-6"},[t("div",{class:"h-0.5 w-12 bg-primary"}),t("h2",{class:"text-xl font-semibold text-dark"},"视频播放"),t("div",{class:"flex-1 h-0.5 bg-primary/20"})],-1)),t("div",ye,[t("video",{ref_key:"videoRef",ref:o,src:r.value.url,preload:"metadata",class:"w-full h-full object-contain",onTimeupdate:ee,onLoadedmetadata:K,onWaiting:e[0]||(e[0]=l=>k.value=!0),onPlaying:e[1]||(e[1]=l=>{k.value=!1,g()}),onEnded:ae,onClick:N},null,40,be),k.value?(u(),i("div",ke,e[6]||(e[6]=[t("div",{class:"w-14 h-14 border-3 border-primary border-t-transparent rounded-full animate-spin"},null,-1)]))):R("",!0),t("div",{class:U(["absolute inset-0 bg-gradient-to-t from-dark/90 via-dark/30 to-transparent flex flex-col justify-end opacity-0 transition-opacity duration-300",{"opacity-100":_.value||M.value||k.value}]),onMouseenter:e[3]||(e[3]=l=>{_.value=!0,g()}),onMouseleave:e[4]||(e[4]=l=>ne())},[t("div",_e,[t("div",{ref_key:"progressBarRef",ref:C,class:"w-full h-2 bg-dark/60 rounded-full cursor-pointer group relative",onClick:te,onMousedown:Q(X,["prevent"]),onTouchstart:Q(X,["prevent"])},[t("div",{class:"h-full bg-primary rounded-full transition-all duration-150",style:W({width:`${b.value}%`})},null,4),t("div",{class:"absolute top-1/2 w-5 h-5 bg-light rounded-full shadow-lg transition-all duration-150 group-hover:scale-110",style:W({left:`${b.value}%`,transform:"translate(-50%, -50%)",boxShadow:M.value?"0 0 0 4px rgba(99, 102, 241, 0.2)":"none"})},null,4),M.value?(u(),i("div",Me,d(j(B.value)),1)):R("",!0)],544),t("div",Ce,[t("span",null,d(j(L.value)),1),t("span",null,d(j(y.value)),1)])]),t("div",Te,[t("button",{onClick:N,class:"text-xl transition-colors hover:text-primary"},[c.value?(u(),i("svg",Ve,e[7]||(e[7]=[t("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"},null,-1)]))):(u(),i("svg",ze,e[8]||(e[8]=[t("path",{d:"M8 5v14l11-7z"},null,-1)])))]),t("div",Ee,[t("button",{onClick:Y,class:"transition-colors hover:text-primary"},[!p.value&&w.value>.5?(u(),i("svg",Le,e[9]||(e[9]=[t("path",{d:"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z"},null,-1)]))):!p.value&&w.value>0?(u(),i("svg",Be,e[10]||(e[10]=[t("path",{d:"M11 5L6 9H2v6h4l5 4V5zm7.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm-2.5-4.5c.55 0 1 .45 1 1v3c0 .55-.45 1-1 1s-1-.45-1-1v-3c0-.55.45-1 1-1z"},null,-1)]))):(u(),i("svg",$e,e[11]||(e[11]=[t("path",{d:"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5L19.73 13 14 7.27V3H4.27zM14 15.5v-7l-3.5 3.5z"},null,-1)])))]),t("input",{type:"range",min:"0",max:"1",step:"0.05",value:w.value,onInput:Z,onMousedown:e[2]||(e[2]=l=>g()),class:"w-24 h-1.5 bg-dark/60 rounded-full appearance-none cursor-pointer group-hover:bg-dark/80 transition-colors"},null,40,He)]),t("div",Se,[t("button",je,[S(d(H.value)+"x ",1),e[12]||(e[12]=t("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))]),t("div",Re,[(u(!0),i(D,null,A(oe.value,l=>(u(),i("button",{key:l,onClick:v=>{se(l),g()},class:U(["block w-full text-left px-3 py-2 text-sm hover:bg-dark/50 transition-colors",{"bg-primary text-light":H.value===l,"text-light/90":H.value!==l}])},d(l)+"x ",11,De))),128))])]),t("button",{onClick:le,class:"ml-auto transition-colors hover:text-primary"},[P.value?(u(),i("svg",Ne,e[14]||(e[14]=[t("path",{d:"M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"},null,-1)]))):(u(),i("svg",Pe,e[13]||(e[13]=[t("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"},null,-1)])))])])],34)])]),e[24]||(e[24]=t("div",{class:"max-w-6xl mx-auto my-8"},[t("div",{class:"h-0.5 w-full bg-gradient-to-r from-transparent via-primary/30 to-transparent"})],-1)),t("div",Fe,[e[22]||(e[22]=t("div",{class:"absolute top-1/2 left-20 w-40 h-40 bg-secondary/5 rounded-full blur-2xl -z-10"},null,-1)),t("div",Xe,[t("h1",qe,d(r.value.title),1),t("div",Ie,[e[18]||(e[18]=t("span",{class:"flex items-center gap-1.5"},[t("svg",{class:"w-4.5 h-4.5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})])],-1)),t("span",Oe,[e[16]||(e[16]=t("svg",{class:"w-4.5 h-4.5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),S(" "+d(new Date(r.value.uploadTime).toLocaleString()),1)]),t("span",Ue,[e[17]||(e[17]=t("svg",{class:"w-4.5 h-4.5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1)),t("span",Qe,d(r.value.category),1)])]),t("div",We,[e[19]||(e[19]=t("h3",{class:"font-semibold text-dark mb-3 text-lg flex items-center gap-2"},[t("svg",{class:"w-5 h-5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),S(" 视频简介 ")],-1)),t("p",Ae,d(r.value.desc),1)])]),t("div",Ge,[t("h2",Je,[e[20]||(e[20]=t("span",{class:"w-2 h-2 bg-primary rounded-full"},null,-1)),e[21]||(e[21]=S(" 相关推荐 ")),t("span",Ke,d(f.value.length)+" 个视频",1)]),f.value.length?(u(),i("div",Ye,[(u(!0),i(D,null,A(f.value,l=>(u(),i("div",{key:l.id,class:"flex gap-3 cursor-pointer bg-light border border-primary/5 rounded-lg overflow-hidden shadow-sm transition-all duration-300 hover-lift",onClick:v=>re(l),onMouseenter:e[5]||(e[5]=v=>g())},[t("div",et,[t("img",{src:$(l.cover),alt:"推荐视频缩略图",class:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105",loading:"lazy"},null,8,tt),t("span",lt,d(l.duration),1)]),t("div",at,[t("h4",ot,d(l.title),1),t("p",st,d(l.uploadTime),1)])],40,Ze))),128))])):R("",!0)])])])])],64))}}),vt=fe(nt,[["__scopeId","data-v-e9ebac55"]]);export{vt as default};
